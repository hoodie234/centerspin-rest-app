<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/angular_material/1.1.0/angular-material.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular.min.js"></script>
          <!-- Angular Material requires Angular.js Libraries -->
        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-animate.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-aria.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-messages.min.js"></script>
        <!-- Angular Material Library -->
        <script src="https://ajax.googleapis.com/ajax/libs/angular_material/1.1.0/angular-material.min.js"></script>

        <script src="scripts/centerspinMain.js"></script>

        
    
        <title>Start Page</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        
        <style>
            
            #submit {
                display: none;
            }
            .text-center{
                text-align:  center !important;
            }
        </style>
    </head>
    <body layout="row"  layout-align="center" ng-controller="centerspinMainCtrl" ng-app="centerspinApp">
        <md-toolbar class="text-center">
            <h2 flex md-truncate>CenterSpin</h2>
        </md-toolbar>
        <md-content layout-gt-sm class="md-content md-padding">
            <md-navbar  nav-bar-aria-label="navigation links">
                <md-nav-item name="feed">
                    Feed
                </md-nav-item>
                <md-nav-item name="profile">
                    Profile
                </md-nav-item>
                <md-nav-item name="explore">
                    Explore
                </md-nav-item>
            </md-navbar>
        </md-content>

        <p>Welcome to the submit page</p>
        
        
        <input id="url" type="text" placeholder="Article URL">
        <button id="scrape">Submit URL</button>
        
        <div id="results"></div>
        
        <button id="submit">Submit Article</button>
        
        <script>
            
            
            var articleData;
            
            $("#scrape").click(function(){
                var urlString = $("#url").val();
            
                console.log(location.href);

                var articleRequest = {
                    url : urlString
                };

                $.post("centerspin/scraper", JSON.stringify(articleRequest), function(response) {
                    $("#results").text(JSON.stringify(response));
                    
                    articleData = response.article;
                    
                    if (response.sourceState === "approved") {
                        $("#submit").show();
                    }
                });
            });
            
            
            $("#submit").click(function() {
                
                console.log("Clicked submit button");
                
                articleData.type = "news";
                articleData.topic = "congress";
                
                console.log(JSON.stringify(articleData));
                
                $.post("centerspin/submit/article", JSON.stringify(articleData), function(response) {
                    $("#results").text(response.message);
                });
                
            });
            
        </script>
    </body>
</html>
